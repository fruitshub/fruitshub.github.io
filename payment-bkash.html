<!DOCTYPE html>
<html>
<head>
  <title>bKash Payment</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Include the bKash script provided by bKash -->
  <script src="https://scripts.sandbox.bka.sh/checkout/pay/js/bKash-checkout.js"></script>
</head>
<body>
  <button id="bKash_button">Pay with bKash</button>

  <script>
    $(document).ready(function () {
      // Initialize bKash payment
      bKash.init({
        paymentMode: 'checkout',
        paymentRequest: {
          amount: '85.50',
          intent: 'sale',
          currency: 'BDT',
          merchantInvoiceNumber: '123456'
        },
        createRequest: function (request) {
          $.ajax({
            url: 'https://script.google.com/macros/s/AKfycbxKv6UlCca9dhTPi6Opx9W5mtguoLbwp2sB_Jn_hcVsLkUynil1uj0IciG8tGpMFlljbQ/exec',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(request),
            success: function (data) {
              if (data && data.paymentID != null) {
                bKash.create().onSuccess(data);
              } else {
                bKash.create().onError();
                alert(data.errorMessage);
              }
            },
            error: function () {
              bKash.create().onError();
              alert('An error occurred during createRequest.');
            }
          });
        },
        executeRequestOnAuthorization: function () {
          $.ajax({
            url: 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ paymentID: paymentID }),
            success: function (data) {
              if (data && data.paymentID != null) {
                window.location.href = "/success_page.html";
              } else {
                bKash.execute().onError();
                alert(data.errorMessage);
              }
            },
            error: function () {
              bKash.execute().onError();
              alert('An error occurred during executeRequest.');
            }
          });
        },
        onClose: function () {
          alert('User has clicked the close button');
        }
      });

      $('#bKash_button').removeAttr('disabled');
    });
  </script>
</body>
</html>
